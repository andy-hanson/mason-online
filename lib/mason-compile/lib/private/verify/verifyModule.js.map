{"version":3,"sources":["private/verify/verifyModule.js"],"names":[],"mappings":"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","file":"private/verify/verifyModule.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../context', '../ast/BuildEntry', '../util', './autoBlockKind', './context', './SK', './verifyLines', './verifyLocals', './verifyVal'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    const Op_1 = require('op/Op');\n    const context_1 = require('../context');\n    const BuildEntry_1 = require('../ast/BuildEntry');\n    const util_1 = require('../util');\n    const autoBlockKind_1 = require('./autoBlockKind');\n    const context_2 = require('./context');\n    const SK_1 = require('./SK');\n    const verifyLines_1 = require('./verifyLines');\n    const verifyLocals_1 = require('./verifyLocals');\n    const verifyVal_1 = require('./verifyVal');\n    function verifyModule({ imports, lines, loc }) {\n        for (const _ of imports)\n            verifyImport(_);\n        context_2.withName(context_1.pathOptions.moduleName, () => {\n            verifyModuleLines(lines, loc);\n        });\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = verifyModule;\n    function verifyImport({ imported, opImportDefault }) {\n        for (const _ of imported)\n            verifyLocals_1.addImportedLocal(_);\n        Op_1.opEach(opImportDefault, verifyLocals_1.addImportedLocal);\n    }\n    function verifyModuleLines(lines, loc) {\n        context_2.results.moduleKind = Op_1.caseOp(autoBlockKind_1.opBlockBuildKind(lines, loc), buildKind => {\n            if (buildKind === 5) {\n                for (const line of lines)\n                    if (line instanceof BuildEntry_1.ObjEntry)\n                        context_2.results.objEntryExports.add(line);\n                verifyLines_1.default(lines);\n                return 2;\n            }\n            else {\n                verifyLines_1.verifyBuiltLines(lines, loc);\n                return buildKind === 3 ? 3 : 4;\n            }\n        }, () => {\n            if (util_1.isEmpty(lines))\n                return 0;\n            else {\n                const l = util_1.last(lines);\n                const lastSK = SK_1.getLineSK(l);\n                if (lastSK === 0) {\n                    verifyLines_1.default(lines);\n                    return 0;\n                }\n                else {\n                    const newLocals = verifyLines_1.default(util_1.rtail(lines));\n                    verifyLocals_1.plusLocals(newLocals, () => verifyVal_1.ensureValAndVerify(l));\n                    return 1;\n                }\n            }\n        });\n    }\n});\n"],"sourceRoot":"/source/"}